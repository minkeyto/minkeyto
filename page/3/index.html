<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>灵熙云工作室 - 实践出真理！</title><meta name="description" content="空话连篇，不如劳动实践！"><meta name="keywords" content="java,javaweb,mysql,oracle,html,css,javascrip,servlet,spring,Hibernate,Mybatis,Maven,Redis,Linux,Docker"><meta name="author" content="灵熙云,minkeyto@qq.com"><meta name="copyright" content="灵熙云"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/file/favicon.png"><link rel="canonical" href="http://www.goitman.cn/page/3/"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="preconnect" href="//zz.bdstatic.com"/><meta name="msvalidate.01" content="8izvf3GqbX"/><meta property="og:type" content="website"><meta property="og:title" content="灵熙云工作室"><meta property="og:url" content="http://www.goitman.cn/page/3/"><meta property="og:site_name" content="灵熙云工作室"><meta property="og:description" content="空话连篇，不如劳动实践！"><meta property="og:image" content="http://www.goitman.cn/file/head.jpg"><meta property="article:published_time" content="2023-05-11T08:45:26.926Z"><meta property="article:modified_time" content="2023-05-11T08:45:26.926Z"><meta name="twitter:card" content="summary"><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#000')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fff')
  }
}

var getCookies = function (name) {
  const value = `; ${document.cookie}`
  const parts = value.split(`; ${name}=`)
  if (parts.length === 2) return parts.pop().split(';').shift()
}

var autoChangeMode = 'false'
var t = getCookies('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (Cookies.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?5c009f46ba6df7bc385f101477536214";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: false,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: {"bookmark":{"message_prev":"按","message_next":"键将本页加入书签"},"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  justifiedGallery: {
    js: 'https://fastly.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://fastly.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: true,
  highlightCopy: true,
  highlightLang: true,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false    
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isSidebar: false,
  postUpdate: '2023-05-11 16:45:26'
}</script><noscript><style>
#nav {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><link rel="stylesheet" href="/css/effect.css"><meta name="generator" content="Hexo 6.2.0"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/file/head.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">64</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">259</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">18</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/notes/"><i class="fa-fw fa fa-book"></i><span> 笔记</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-users"></i><span> 友链&amp;留言板</span></a></div></div></div></div><div id="body-wrap"><header class="full_page" id="page-header" style="background-image: url(/file/bg1.jpg)"><nav id="nav"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">灵熙云工作室</a></span><span class="pull-right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/notes/"><i class="fa-fw fa fa-book"></i><span> 笔记</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-users"></i><span> 友链&amp;留言板</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="site-info"><h1 id="site_title">灵熙云工作室</h1><div id="site_subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="https://blog.csdn.net/minkeyto" target="_blank" title="CSDN"><i class="fa fa-rss-square"></i></a><a class="social-icon" href="https://github.com/wangdaicong" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="/file/tb.jpg" target="_blank" title="taobao"><i class="fa fa-shopping-cart"></i></a><a class="social-icon" href="mailto:minkeyto@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="/about/" target="_blank" title="Profile"><i class="fa fa-address-book"></i></a></div></div><div id="scroll_down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout_page" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2022/07/19/%E9%80%9A%E7%94%A8Service%20+%20%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%AE%8C%E7%BE%8E%E8%A7%A3%E5%86%B3%E6%89%B9%E5%A4%84%E7%90%86%E9%97%AE%E9%A2%98/" title="通用Service + 多线程完美解决批处理问题">     <img class="post_bg" data-src="https://s2.loli.net/2022/07/19/kA8NoEuy29wmG5n.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="通用Service + 多线程完美解决批处理问题"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/07/19/%E9%80%9A%E7%94%A8Service%20+%20%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%AE%8C%E7%BE%8E%E8%A7%A3%E5%86%B3%E6%89%B9%E5%A4%84%E7%90%86%E9%97%AE%E9%A2%98/" title="通用Service + 多线程完美解决批处理问题">通用Service + 多线程完美解决批处理问题</a><div class="article-meta-wrap"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2022-07-19 15:05:57"><i class="far fa-calendar-alt"></i>2022-07-19</span><span class="article-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2022-08-23 18:12:00"><i class="fas fa-history"></i>2022-08-23</span></time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E6%8A%80%E6%9C%AF%E4%B8%93%E9%A2%98/">技术专题</a><i class="fas fa-angle-right"></i><a class="article-meta__categories" href="/categories/%E6%8A%80%E6%9C%AF%E4%B8%93%E9%A2%98/%E5%A4%9A%E7%BA%BF%E7%A8%8B/">多线程</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag article-meta__icon"></i><a class="article-meta__tags" href="/tags/Runnable/">Runnable</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/Callable/">Callable</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/">多线程</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E4%BA%8B%E5%8A%A1%E6%8E%A7%E5%88%B6/">事务控制</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/java8/">java8</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E5%8F%8C%E9%87%8D%E5%87%BD%E6%95%B0/">双重函数</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E6%B3%9B%E5%9E%8B/">泛型</a></span></div><div class="content">前言在对数据量大的情况下，进行批量操作的时候，效率直接拉跨，同时还要考虑事务机制问题。那是否有既简单又通用的批处理思路呢？当然，多线程执行批量任务就是一种十分重要的操作思路
步骤
获取数据库连接，控制事务机制
对大集合进行拆分成N个小集合。
开启线程池，对小集合进行批量更新操作，并返回执行结果。
线程批量提交，返回Future对象，进而判断事务是否需要提交或回滚

实战Servicepackage cn.goitman.service;import com.google.common.collect.Lists;import org.apache.ibatis.session.SqlSession;import org.apache.ibatis.session.SqlSessionFactory;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Service;import java.sql.Connection;import java ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2022/07/09/SpringBoot%E5%90%8C%E6%97%B6%E6%94%AF%E6%8C%81%20form%20%E8%A1%A8%E5%8D%95%E3%80%81form-data%E3%80%81json%20%E7%9A%84%E4%BC%98%E9%9B%85%E5%86%99%E6%B3%95/" title="SpringBoot同时支持 form 表单、form-data、json 的优雅写法">     <img class="post_bg" data-src="https://s2.loli.net/2022/07/09/v7AEHYBnRPbskaj.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SpringBoot同时支持 form 表单、form-data、json 的优雅写法"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/07/09/SpringBoot%E5%90%8C%E6%97%B6%E6%94%AF%E6%8C%81%20form%20%E8%A1%A8%E5%8D%95%E3%80%81form-data%E3%80%81json%20%E7%9A%84%E4%BC%98%E9%9B%85%E5%86%99%E6%B3%95/" title="SpringBoot同时支持 form 表单、form-data、json 的优雅写法">SpringBoot同时支持 form 表单、form-data、json 的优雅写法</a><div class="article-meta-wrap"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2022-07-09 02:07:16"><i class="far fa-calendar-alt"></i>2022-07-09</span><span class="article-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2022-07-09 02:18:28"><i class="fas fa-history"></i>2022-07-09</span></time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E5%BE%AE%E6%9C%8D%E5%8A%A1/">微服务</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag article-meta__icon"></i><a class="article-meta__tags" href="/tags/SpringBoot/">SpringBoot</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/form/">form</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/form-data/">form-data</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/json/">json</a></span></div><div class="content">在 Java 中，一个接口只支持一种 content-type，json 就用 @RequestBody，form 表单就用 @RequestParam 或不写，form-data 就用 MultipartFile。
兼容版本如果要把在一个接口中同时兼容三种，比较笨的办法就是获取 HttpServletRequest，然后自己再写方法解析。类似如下：
private Map&lt;String, Object&gt; getParams(HttpServletRequest request) &#123;    String contentType = request.getContentType();    if (contentType.contains(&quot;application/json&quot;)) &#123;        // json 解析...        return null;    &#125; else if (contentType.contains(&quot;application/x-www-form-urlencoded&quot;)) ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2022/07/06/%E4%B8%80%E9%94%AE%E9%83%A8%E7%BD%B2Redis%E4%BB%BB%E6%84%8F%E7%89%88%E6%9C%AC/" title="一键部署Redis任意版本">     <img class="post_bg" data-src="https://s2.loli.net/2022/07/06/VOcJRdtLrA7oP18.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="一键部署Redis任意版本"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/07/06/%E4%B8%80%E9%94%AE%E9%83%A8%E7%BD%B2Redis%E4%BB%BB%E6%84%8F%E7%89%88%E6%9C%AC/" title="一键部署Redis任意版本">一键部署Redis任意版本</a><div class="article-meta-wrap"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2022-07-06 10:36:09"><i class="far fa-calendar-alt"></i>2022-07-06</span><span class="article-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2022-08-10 15:31:18"><i class="fas fa-history"></i>2022-08-10</span></time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2/">服务部署</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag article-meta__icon"></i><a class="article-meta__tags" href="/tags/%E7%BC%93%E5%AD%98/">缓存</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/Linux/">Linux</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/Redis/">Redis</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/shell%E8%84%9A%E6%9C%AC/">shell脚本</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E9%83%A8%E7%BD%B2/">部署</a></span></div><div class="content">今天给大家分享一个超级实用的脚本，Linux环境下一键自动安装部署Redis的任意版本，记住是任意版本哦！

脚本用法：chmod 755 redis-install.sh &amp;&amp; sh redis-install.sh 4.0.10 （后面跟的是你需要的版本号，需要什么版本就写什么版本），我这里安装的4.0.10

执行脚本#! /usr/bin/bash##redis任何版本全程自动化源码编译安装##用法： sh redis-install.sh 4.0.10 （后面跟的是你需要的版本号，需要什么版本就写什么版本），我这里安装的4.0.10version=$1usage()&#123;echo &quot;usage: $0 version&quot;&#125;if [ $# -ne 1 ]thenusageexit -1fi#Redis安装包下载cd /usr/local/srcif [ ! -f redis-$&#123;version&#125;.tar.gz ]thencurl -o /usr/local/src/redis-$&#123;version&# ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2022/06/29/Redis%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%E7%9A%848%E5%A4%A7%E5%9D%91/" title="Redis分布式锁的8大坑">     <img class="post_bg" data-src="https://s2.loli.net/2022/06/29/wOHE6nSBAbjF9Dd.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Redis分布式锁的8大坑"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/06/29/Redis%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%E7%9A%848%E5%A4%A7%E5%9D%91/" title="Redis分布式锁的8大坑">Redis分布式锁的8大坑</a><div class="article-meta-wrap"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2022-06-29 16:27:46"><i class="far fa-calendar-alt"></i>2022-06-29</span><span class="article-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2022-06-29 16:37:09"><i class="fas fa-history"></i>2022-06-29</span></time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E6%8A%80%E6%9C%AF%E4%B8%93%E9%A2%98/">技术专题</a><i class="fas fa-angle-right"></i><a class="article-meta__categories" href="/categories/%E6%8A%80%E6%9C%AF%E4%B8%93%E9%A2%98/%E7%BC%93%E5%AD%98/">缓存</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag article-meta__icon"></i><a class="article-meta__tags" href="/tags/lua%E8%84%9A%E6%9C%AC/">lua脚本</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E5%8F%AF%E9%87%8D%E5%85%A5%E9%94%81/">可重入锁</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/Redis%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81/">Redis分布式锁</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E5%8E%9F%E5%AD%90%E6%80%A7/">原子性</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E8%AF%BB%E5%86%99%E9%94%81/">读写锁</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6/">主从复制</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/RedissonRedLock/">RedissonRedLock</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/Redisson/">Redisson</a></span></div><div class="content">在分布式系统中，由于Redis分布式锁相对于更简单和高效，成为了分布式锁的首先，被用到了很多实际业务场景当中。
但不是说用了Redis分布式锁，就可以高枕无忧了，如果没有用好或者用对，也会引来一些意想不到的问题。
今天一起聊聊Redis分布式锁的一些坑，给有需要的朋友一个参考。

非原子操作使用Redis的分布式锁，首先想到的可能是setNx命令。
if (jedis.setnx(lockKey, val) == 1) &#123;   jedis.expire(lockKey, timeout);&#125;

容易，三下五除二就可以把代码写好。

这段代码确实可以加锁成功，但有没有发现什么问题？
加锁操作和后面的设置超时时间是分开的，并非原子操作。
假如加锁成功，但是设置超时时间失败了，该lockKey就变成永不失效。假如在高并发场景中，有大量的lockKey加锁成功了，但不会失效，有可能直接导致redis内存空间不足。

那么，有没有保证原子性的加锁命令呢？
答案是：有，请看下面。
忘了释放锁上面说到使用setNx命令加锁操作和设置超时时间是分开的，并非原子操作。
而在Redis ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2022/06/21/SpringBoot%E6%89%93%E5%8C%85%20+%20shell%E8%84%9A%E6%9C%AC%E9%83%A8%E7%BD%B2/" title="SpringBoot打包 + shell脚本部署">     <img class="post_bg" data-src="https://s2.loli.net/2022/06/21/RJUQtBcfWdCZIMF.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SpringBoot打包 + shell脚本部署"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/06/21/SpringBoot%E6%89%93%E5%8C%85%20+%20shell%E8%84%9A%E6%9C%AC%E9%83%A8%E7%BD%B2/" title="SpringBoot打包 + shell脚本部署">SpringBoot打包 + shell脚本部署</a><div class="article-meta-wrap"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2022-06-21 15:54:06"><i class="far fa-calendar-alt"></i>2022-06-21</span><span class="article-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2022-08-10 15:31:32"><i class="fas fa-history"></i>2022-08-10</span></time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2/">服务部署</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag article-meta__icon"></i><a class="article-meta__tags" href="/tags/SpringBoot/">SpringBoot</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/shell%E8%84%9A%E6%9C%AC/">shell脚本</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E9%83%A8%E7%BD%B2/">部署</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/assembly/">assembly</a></span></div><div class="content">SpringBoot打包并结合shell脚本命令部署，重点在分享一个shell程序启动工具，希望能便利工作：


profiles指定不同环境的配置
maven-assembly-plugin打发布压缩包
shenniu_publish.sh程序启动工具
linux上使用shenniu_publish.sh启动程序


示例项目文件结构：

profiles指定不同环境的配置通常一套程序分为了很多个部署环境：开发，测试，uat，线上 等，要想对这些环境区分配置文件，可以通过两种方式：


通过application.yml中编码指定profile.active=uat方式指定
通过pom.xml中profiles来区分不同环境对应的配置文件夹，人工可以手动在idea勾选生成不同环境的包(推荐)


这里要讲的是第二种，首先在pom.xml中配置如下内容： 
&lt;profiles&gt;    &lt;profile&gt;        &lt;id&gt;node&lt;/id&gt;        &lt;properties&gt;            &lt;!--传递给 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2022/06/10/So%20easy%20%E5%B0%86%E7%A8%8B%E5%BA%8F%E9%83%A8%E7%BD%B2%E5%88%B0%E6%9C%8D%E5%8A%A1%E5%99%A8/" title="So easy 将程序部署到服务器">     <img class="post_bg" data-src="https://s2.loli.net/2022/06/10/uVKZvd31mjSnhlP.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="So easy 将程序部署到服务器"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/06/10/So%20easy%20%E5%B0%86%E7%A8%8B%E5%BA%8F%E9%83%A8%E7%BD%B2%E5%88%B0%E6%9C%8D%E5%8A%A1%E5%99%A8/" title="So easy 将程序部署到服务器">So easy 将程序部署到服务器</a><div class="article-meta-wrap"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2022-06-10 22:52:06"><i class="far fa-calendar-alt"></i>2022-06-10</span><span class="article-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2022-08-10 15:33:03"><i class="fas fa-history"></i>2022-08-10</span></time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2/">服务部署</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag article-meta__icon"></i><a class="article-meta__tags" href="/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/">虚拟机</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/JDK/">JDK</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/MySQL/">MySQL</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/Tomcat/">Tomcat</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E9%95%9C%E5%83%8F/">镜像</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/ip/">ip</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/jar%E5%8C%85/">jar包</a></span></div><div class="content">导入镜像打开VMWare，点击“打开虚拟机”，本文选择centos7.ova镜像存储路径

点击导入

选择“不再显示此消息”，点击“重试”按钮

点击“编辑虚拟机设置”，修改处理器、内存、硬盘等信息后，启动。按Ctrl+Alt键可以切换到windows下。启动成功后，输入账号root密码123456(帐号密码以镜像系统的设置为准)，登录。
配置IP地址先在VMWare里设置好网络连接方式为桥接模式

有关于centos7获取IP地址的方法主要有两种，


动态获取ip
设置静态ip


动态获取ip前提是你的路由器已经开启了DHCP，修改网卡配置文件
vi /etc/sysconfig/network-scripts/ifcfg-enp0s3# ifcfg-enp0s3 为网卡名称


动态获取IP地址需要修改两处地方即可
BOOTPROTO=&quot;dhcp&quot;ONBOOT=&quot;yes&quot;

修改后重启一下网络服务即可 systemctl restart network
[root@mini ~]# systemctl restart network[r ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2022/06/01/%E5%BB%B6%E8%BF%9F%E4%BB%BB%E5%8A%A1%E7%9A%8410%E7%A7%8D%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F/" title="延迟任务的10种实现方式">     <img class="post_bg" data-src="https://s2.loli.net/2022/06/01/f2n9FbBvNVCiAxp.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="延迟任务的10种实现方式"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/06/01/%E5%BB%B6%E8%BF%9F%E4%BB%BB%E5%8A%A1%E7%9A%8410%E7%A7%8D%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F/" title="延迟任务的10种实现方式">延迟任务的10种实现方式</a><div class="article-meta-wrap"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2022-06-01 16:04:44"><i class="far fa-calendar-alt"></i>2022-06-01</span><span class="article-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2022-06-01 16:19:47"><i class="fas fa-history"></i>2022-06-01</span></time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E6%8A%80%E6%9C%AF%E4%B8%93%E9%A2%98/">技术专题</a><i class="fas fa-angle-right"></i><a class="article-meta__categories" href="/categories/%E6%8A%80%E6%9C%AF%E4%B8%93%E9%A2%98/%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6/">任务调度</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag article-meta__icon"></i><a class="article-meta__tags" href="/tags/Quartz/">Quartz</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/RabbitMQ/">RabbitMQ</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/Redis/">Redis</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/Netty/">Netty</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/DelayQueue/">DelayQueue</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/ScheduledExecutorService/">ScheduledExecutorService</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/Scheduled/">Scheduled</a></span></div><div class="content">延迟任务的10种实现方式，主要内容如下：


手动无线循环
ScheduledExecutorService
DelayQueue
Redis zset 数据判断的方式
Redis 键空间通知的方式
Netty 提供的 HashedWheelTimer 工具类
RabbitMQ 死信队列
RabbitMQ 延迟消息插件 rabbitmq-delayed-message-exchange
Spring Scheduled
Quartz


什么是延迟任务顾明思议，我们把需要延迟执行的任务叫做延迟任务。延迟任务的使用场景有以下这些：


红包 24 小时未被查收，需要延迟执退还业务；
每个月账单日，需要给用户发送当月的对账单；
订单下单之后 30 分钟后，用户如果没有付钱，系统需要自动取消订单。


等事件都需要使用延迟任务。
延迟任务实现思路分析延迟任务实现的关键是在某个时间节点执行某个任务。基于这个信息我们可以想到实现延迟任务的手段有以下两个：


自己手写一个“死循环”一直判断当前时间节点有没有要执行的任务；
借助JDK或者第三方提供的工具类来实现延迟任务。



JDK 实现延迟任 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2022/05/25/SpringBoot%E4%B8%AD%E5%AE%9E%E7%8E%B0%E8%B7%A8%E5%9F%9F%E7%9A%84%205%20%E7%A7%8D%E6%96%B9%E5%BC%8F/" title="SpringBoot中实现跨域的 5 种方式">     <img class="post_bg" data-src="https://s2.loli.net/2022/05/25/u9mjXURNMYChHgJ.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SpringBoot中实现跨域的 5 种方式"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/05/25/SpringBoot%E4%B8%AD%E5%AE%9E%E7%8E%B0%E8%B7%A8%E5%9F%9F%E7%9A%84%205%20%E7%A7%8D%E6%96%B9%E5%BC%8F/" title="SpringBoot中实现跨域的 5 种方式">SpringBoot中实现跨域的 5 种方式</a><div class="article-meta-wrap"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2022-05-25 16:13:51"><i class="far fa-calendar-alt"></i>2022-05-25</span><span class="article-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2022-05-25 16:40:04"><i class="fas fa-history"></i>2022-05-25</span></time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E5%BE%AE%E6%9C%8D%E5%8A%A1/">微服务</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag article-meta__icon"></i><a class="article-meta__tags" href="/tags/%E5%90%8C%E6%BA%90%E7%AD%96%E7%95%A5/">同源策略</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E8%B7%A8%E5%9F%9F/">跨域</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/CORS/">CORS</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E5%85%A8%E5%B1%80%E8%B7%A8%E5%9F%9F/">全局跨域</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E5%B1%80%E9%83%A8%E8%B7%A8%E5%9F%9F/">局部跨域</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E8%BF%87%E6%BB%A4%E5%99%A8/">过滤器</a></span></div><div class="content">为什么会出现跨域问题出于浏览器的同源策略限制。同源策略（Sameoriginpolicy）是一种约定，它是浏览器最核心也最基本的安全功能，如果缺少了同源策略，则浏览器的正常功能可能都会受到影响。可以说Web是构建在同源策略基础之上的，浏览器只是针对同源策略的一种实现。
同源策略会阻止一个域的javascript脚本和另外一个域的内容进行交互。所谓同源（即指在同一个域）就是两个页面具有相同的协议（protocol），主机（host）和端口号（port）
什么是跨域当一个请求url的协议、域名、端口三者之间任意一个与当前页面url不同即为跨域

非同源限制

无法读取非同源网页的 Cookie、LocalStorage 和 IndexedDB
无法接触非同源网页的 DOM
无法向非同源地址发送 AJAX 请求


java实现对于 CORS的跨域请求，主要有以下几种方式可供选择：


返回新的CorsFilter
重写 WebMvcConfigurer
使用注解 @CrossOrigin
手动设置响应头 (HttpServletResponse)
自定 web filter 实现跨域


 ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2022/05/25/Redis%E9%AB%98%E6%95%88%E7%82%B9%E8%B5%9E%E4%B8%8E%E5%8F%96%E6%B6%88%E5%8A%9F%E8%83%BD/" title="Redis高效点赞与取消功能">     <img class="post_bg" data-src="https://s2.loli.net/2022/05/25/re4jlqbU9tEQPak.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Redis高效点赞与取消功能"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/05/25/Redis%E9%AB%98%E6%95%88%E7%82%B9%E8%B5%9E%E4%B8%8E%E5%8F%96%E6%B6%88%E5%8A%9F%E8%83%BD/" title="Redis高效点赞与取消功能">Redis高效点赞与取消功能</a><div class="article-meta-wrap"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2022-05-25 11:07:34"><i class="far fa-calendar-alt"></i>2022-05-25</span><span class="article-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2022-05-30 15:58:25"><i class="fas fa-history"></i>2022-05-30</span></time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E6%8A%80%E6%9C%AF%E4%B8%93%E9%A2%98/">技术专题</a><i class="fas fa-angle-right"></i><a class="article-meta__categories" href="/categories/%E6%8A%80%E6%9C%AF%E4%B8%93%E9%A2%98/%E7%BC%93%E5%AD%98/">缓存</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag article-meta__icon"></i><a class="article-meta__tags" href="/tags/%E7%BC%93%E5%AD%98/">缓存</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/Quartz/">Quartz</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E7%82%B9%E8%B5%9E/">点赞</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/Redis/">Redis</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E9%92%A9%E5%AD%90%E5%87%BD%E6%95%B0/">钩子函数</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/Scheduling/">Scheduling</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E4%BA%8B%E5%8A%A1%E6%94%AF%E6%8C%81/">事务支持</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E5%BA%8F%E5%88%97%E5%8C%96/">序列化</a></span></div><div class="content">

像CSDN的点赞功能只记录了数量，微信朋友圈的点赞功能有显示点赞人头像(获取userId查询用户信息封装返回即可)
点赞、取消点赞是高频次的操作，若每次都读写数据库，大量的操作会影响数据库性能，甚至宕机，所以用缓存处理再合适不过。本文以文章点赞为例来展开叙述
数据格式选择Redis有5种数据结构分别为：String（字符串）、List（列表）、Set（集合）、Hash（散列）、Zset（有序集合）。
由于需要记录文章和点赞人，还有点赞状态（点赞、取消），分析下 Redis 数据格式中Hash最合适。
因为Hash里的数据都是存在一个Key中，通过Key很方便的把所有的点赞数据都取出。Key里面的数据还可以存成键值对的形式，方便存入点赞人、被点赞人和点赞状态。

文章 id 为 articleId，点赞人的 id 为 userId ，点赞状态为 1(点赞)和0(取消点赞)。文章 id 和点赞人 id 作为HashKey，两个 id 中间用::隔开，点赞状态作为HashValue。


整合SpringBoot依赖&lt;dependency&gt;    &lt;groupId&gt ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2022/04/27/So%20easy%20Spring%E4%BA%8B%E5%8A%A1%E5%9B%9E%E6%BB%9A%E6%9C%BA%E5%88%B6/" title="So easy Spring事务回滚机制">     <img class="post_bg" data-src="https://s2.loli.net/2022/04/27/9xQwapEFrtc4HnP.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="So easy Spring事务回滚机制"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/04/27/So%20easy%20Spring%E4%BA%8B%E5%8A%A1%E5%9B%9E%E6%BB%9A%E6%9C%BA%E5%88%B6/" title="So easy Spring事务回滚机制">So easy Spring事务回滚机制</a><div class="article-meta-wrap"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2022-04-27 16:57:26"><i class="far fa-calendar-alt"></i>2022-04-27</span><span class="article-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2022-08-11 09:48:47"><i class="fas fa-history"></i>2022-08-11</span></time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag article-meta__icon"></i><a class="article-meta__tags" href="/tags/%E4%BA%8B%E5%8A%A1%E5%9B%9E%E6%BB%9A/">事务回滚</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E7%BC%96%E7%A8%8B%E5%BC%8F/">编程式</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E5%A3%B0%E6%98%8E%E5%BC%8F/">声明式</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/Transactional/">Transactional</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E/">存储引擎</a></span></div><div class="content">事务控制的3种方式
编程式事务：直接在代码里手动开启事务，手动提交，手动回滚。优点就是可以灵活控制，缺点就是太麻烦了，太多重复的代码了。
声明式事务：就是使用Spring Aop配置事务，这种方式简化了编码。需要注意的是切入点表达式一定要写正确。
注解事务：直接在Service层的方法上面加上@Transactional注解，最简单方便的方式。

伪代码排序往后的方法报错，导致排序前的方法不回滚，如下：updataFlag方法出错，analyseRedBall 和 analyseBlueBall 方法不会回滚
public void statistics() &#123;	// 三个子方法中有操作数据库方法    analyseRedBall(periods, redBalls);    analyseBlueBall(periods, blueBalls);    updataFlag(periods);&#125;

为什么不会滚呢Spring默认情况下是捕获到方法的RuntimeException异常，也就是说只要属于RuntimeException异常或及其子类都能回滚。不属于 ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/2/"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/4/"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside_content" id="aside_content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><img class="avatar-img" src="/file/head.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">灵熙云</div><div class="author-info__description">空话连篇，不如劳动实践！</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives"><div class="headline">文章</div><div class="length_num">64</div></a></div><div class="card-info-data-item is-center">      <a href="/tags"><div class="headline">标签</div><div class="length_num">259</div></a></div><div class="card-info-data-item is-center">     <a href="/categories"><div class="headline">分类</div><div class="length_num">18</div></a></div></div><div class="card-info-bookmark is-center"><button class="button--animated" id="bookmark-it" type="button" title="加入书签"><i class="fas fa-bookmark"></i><span>加入书签</span></button></div><div class="card-info-social-icons is-center"><a class="social-icon" href="https://blog.csdn.net/minkeyto" target="_blank" title="CSDN"><i class="fa fa-rss-square"></i></a><a class="social-icon" href="https://github.com/wangdaicong" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="/file/tb.jpg" target="_blank" title="taobao"><i class="fa fa-shopping-cart"></i></a><a class="social-icon" href="mailto:minkeyto@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="/about/" target="_blank" title="Profile"><i class="fa fa-address-book"></i></a></div></div></div><div class="card-widget card-announcement"><div class="card-content"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">你好，欢迎来到我的博客！<img src="/file/wx.png"></div></div></div><div class="card-widget card-recent-post"><div class="card-content"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-recent-item"><div class="aside-recent-post"><a href="/2023/05/11/%E7%A6%8F%E9%9F%B3%EF%BC%9AIDEA%E3%80%81VSCODE%E7%A5%9E%E7%BA%A7%E6%8F%92%E4%BB%B6Bito/"><div class="aside-post-cover"><img class="aside-post-bg" data-src="https://s2.loli.net/2023/05/11/JMdti9qwGao6mFp.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" title="福音：IDEA、VSCODE神级插件Bito" alt="福音：IDEA、VSCODE神级插件Bito"/></div><div class="aside-post-title"><div class="aside-post_title" href="/2023/05/11/%E7%A6%8F%E9%9F%B3%EF%BC%9AIDEA%E3%80%81VSCODE%E7%A5%9E%E7%BA%A7%E6%8F%92%E4%BB%B6Bito/" title="福音：IDEA、VSCODE神级插件Bito">福音：IDEA、VSCODE神级插件Bito</div><time class="aside-post_meta post-meta__date" title="发表于 2023-05-11 16:31:19">2023-05-11</time></div></a></div><div class="aside-recent-post"><a href="/2023/03/28/IP%20%E5%BD%92%E5%B1%9E%E7%94%A8%20Ip2region%20%E5%B0%B1%E5%A4%9F%E4%BA%86/"><div class="aside-post-cover"><img class="aside-post-bg" data-src="https://s2.loli.net/2023/03/28/Zg3mPGHW5ebhp96.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" title="IP 归属用 Ip2region 就够了" alt="IP 归属用 Ip2region 就够了"/></div><div class="aside-post-title"><div class="aside-post_title" href="/2023/03/28/IP%20%E5%BD%92%E5%B1%9E%E7%94%A8%20Ip2region%20%E5%B0%B1%E5%A4%9F%E4%BA%86/" title="IP 归属用 Ip2region 就够了">IP 归属用 Ip2region 就够了</div><time class="aside-post_meta post-meta__date" title="发表于 2023-03-28 15:55:56">2023-03-28</time></div></a></div><div class="aside-recent-post"><a href="/2023/03/15/Java%20+%20lua%20%E5%8F%8C%E5%90%91%E7%BB%84%E5%90%88%E6%8B%B3/"><div class="aside-post-cover"><img class="aside-post-bg" data-src="https://s2.loli.net/2023/03/15/AkeoaJdr52O4uzH.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" title="Java + lua 双向组合拳" alt="Java + lua 双向组合拳"/></div><div class="aside-post-title"><div class="aside-post_title" href="/2023/03/15/Java%20+%20lua%20%E5%8F%8C%E5%90%91%E7%BB%84%E5%90%88%E6%8B%B3/" title="Java + lua 双向组合拳">Java + lua 双向组合拳</div><time class="aside-post_meta post-meta__date" title="发表于 2023-03-15 17:04:16">2023-03-15</time></div></a></div><div class="aside-recent-post"><a href="/2023/03/09/PowerJob%20%E7%AC%AC%E4%B8%89%E4%BB%A3%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6%E6%A1%86%E6%9E%B6/"><div class="aside-post-cover"><img class="aside-post-bg" data-src="https://s2.loli.net/2023/03/09/9DWKqZhVtmnQM71.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" title="PowerJob 第三代任务调度框架" alt="PowerJob 第三代任务调度框架"/></div><div class="aside-post-title"><div class="aside-post_title" href="/2023/03/09/PowerJob%20%E7%AC%AC%E4%B8%89%E4%BB%A3%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6%E6%A1%86%E6%9E%B6/" title="PowerJob 第三代任务调度框架">PowerJob 第三代任务调度框架</div><time class="aside-post_meta post-meta__date" title="发表于 2023-03-09 11:07:01">2023-03-09</time></div></a></div><div class="aside-recent-post"><a href="/2023/02/24/%E7%94%A8Java%E5%BC%80%E5%8F%91%E4%B8%AAChatGPT%20AI%E5%A5%B3%E6%9C%8B%E5%8F%8B/"><div class="aside-post-cover"><img class="aside-post-bg" data-src="https://s2.loli.net/2023/02/24/Uwg7LARSqdt3W5N.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" title="用Java开发个ChatGPT AI女朋友" alt="用Java开发个ChatGPT AI女朋友"/></div><div class="aside-post-title"><div class="aside-post_title" href="/2023/02/24/%E7%94%A8Java%E5%BC%80%E5%8F%91%E4%B8%AAChatGPT%20AI%E5%A5%B3%E6%9C%8B%E5%8F%8B/" title="用Java开发个ChatGPT AI女朋友">用Java开发个ChatGPT AI女朋友</div><time class="aside-post_meta post-meta__date" title="发表于 2023-02-24 15:07:22">2023-02-24</time></div></a></div></div></div></div><div class="card-widget card-categories"><div class="card-content"><div class="item-headline"><i class="fas fa-folder-open"></i><span>分类</span></div><ul class="card-category-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Java%E5%9F%BA%E7%A1%80/"><span class="card-category-list-name">Java基础</span><span class="card-category-list-count">6</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E5%BE%AE%E6%9C%8D%E5%8A%A1/"><span class="card-category-list-name">微服务</span><span class="card-category-list-count">4</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%8A%80%E6%9C%AF%E4%B8%93%E9%A2%98/"><span class="card-category-list-name">技术专题</span><span class="card-category-list-count">23</span></a></li><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%8A%80%E6%9C%AF%E4%B8%93%E9%A2%98/%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6/"><span class="card-category-list-name">任务调度</span><span class="card-category-list-count">3</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%8A%80%E6%9C%AF%E4%B8%93%E9%A2%98/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"><span class="card-category-list-name">多线程</span><span class="card-category-list-count">4</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%8A%80%E6%9C%AF%E4%B8%93%E9%A2%98/%E5%AF%BC%E5%85%A5%E5%AF%BC%E5%87%BA/"><span class="card-category-list-name">导入导出</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%8A%80%E6%9C%AF%E4%B8%93%E9%A2%98/%E5%B7%A5%E4%BD%9C%E6%B5%81/"><span class="card-category-list-name">工作流</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%8A%80%E6%9C%AF%E4%B8%93%E9%A2%98/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/"><span class="card-category-list-name">消息队列</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%8A%80%E6%9C%AF%E4%B8%93%E9%A2%98/%E7%AE%97%E6%B3%95/"><span class="card-category-list-name">算法</span><span class="card-category-list-count">4</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%8A%80%E6%9C%AF%E4%B8%93%E9%A2%98/%E7%BC%93%E5%AD%98/"><span class="card-category-list-name">缓存</span><span class="card-category-list-count">5</span></a></li></ul><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%95%8F%E6%8D%B7%E5%BC%80%E5%8F%91/"><span class="card-category-list-name">敏捷开发</span><span class="card-category-list-count">9</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"><span class="card-category-list-name">数据库</span><span class="card-category-list-count">6</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2/"><span class="card-category-list-name">服务部署</span><span class="card-category-list-count">12</span></a></li><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2/%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1/"><span class="card-category-list-name">文件服务</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2/%E6%97%A5%E5%BF%97%E6%A1%86%E6%9E%B6/"><span class="card-category-list-name">日志框架</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/"><span class="card-category-list-name">负载均衡</span><span class="card-category-list-count">3</span></a></li></ul><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E7%A8%8B%E5%BA%8F%E4%BA%BA%E7%94%9F/"><span class="card-category-list-name">程序人生</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3/"><span class="card-category-list-name">设计思想</span><span class="card-category-list-count">3</span></a></li>
                       
            </ul></div></div><div class="card-widget card-tags"><div class="card-content"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href='/tags/AI/' style='font-size:17px; color:rgb(92, 124, 39)'>AI</a><a href='/tags/AbortPolicy/' style='font-size:16px; color:rgb(63, 163, 159)'>AbortPolicy</a><a href='/tags/Activiti/' style='font-size:21px; color:rgb(2, 34, 169)'>Activiti</a><a href='/tags/Apache/' style='font-size:18px; color:rgb(134, 123, 92)'>Apache</a><a href='/tags/Apifox/' style='font-size:18px; color:rgb(116, 33, 5)'>Apifox</a><a href='/tags/ArrayBlockingQueue/' style='font-size:18px; color:rgb(151, 46, 78)'>ArrayBlockingQueue</a><a href='/tags/Bito/' style='font-size:16px; color:rgb(193, 95, 28)'>Bito</a><a href='/tags/CORS/' style='font-size:20px; color:rgb(7, 46, 107)'>CORS</a><a href='/tags/Caddy/' style='font-size:16px; color:rgb(191, 79, 51)'>Caddy</a><a href='/tags/Callable/' style='font-size:20px; color:rgb(8, 183, 70)'>Callable</a><a href='/tags/CallerRunsPolicy/' style='font-size:21px; color:rgb(109, 98, 74)'>CallerRunsPolicy</a><a href='/tags/ChatGPT/' style='font-size:20px; color:rgb(101, 44, 80)'>ChatGPT</a><a href='/tags/ClassPathResource/' style='font-size:20px; color:rgb(125, 140, 149)'>ClassPathResource</a><a href='/tags/CollectionUtils/' style='font-size:18px; color:rgb(152, 73, 197)'>CollectionUtils</a><a href='/tags/CountDownLatch/' style='font-size:18px; color:rgb(12, 5, 181)'>CountDownLatch</a><a href='/tags/DO/' style='font-size:17px; color:rgb(4, 77, 68)'>DO</a><a href='/tags/DTO/' style='font-size:19px; color:rgb(35, 98, 153)'>DTO</a><a href='/tags/DelayQueue/' style='font-size:18px; color:rgb(1, 72, 77)'>DelayQueue</a><a href='/tags/Disruptor/' style='font-size:18px; color:rgb(36, 112, 130)'>Disruptor</a><a href='/tags/Druid/' style='font-size:16px; color:rgb(105, 68, 167)'>Druid</a><a href='/tags/ELK/' style='font-size:20px; color:rgb(196, 67, 43)'>ELK</a><a href='/tags/Elasticsearch/' style='font-size:18px; color:rgb(199, 66, 113)'>Elasticsearch</a><a href='/tags/Erupt/' style='font-size:17px; color:rgb(76, 166, 135)'>Erupt</a><a href='/tags/FastDFS/' style='font-size:19px; color:rgb(178, 14, 125)'>FastDFS</a><a href='/tags/FileCopyUtils/' style='font-size:21px; color:rgb(26, 198, 95)'>FileCopyUtils</a><a href='/tags/FileZilla/' style='font-size:18px; color:rgb(179, 99, 180)'>FileZilla</a><a href='/tags/Filebeat/' style='font-size:16px; color:rgb(13, 115, 158)'>Filebeat</a><a href='/tags/Fork-Join%E6%A1%86%E6%9E%B6/' style='font-size:19px; color:rgb(4, 195, 160)'>Fork/Join框架</a><a href='/tags/Geohash/' style='font-size:20px; color:rgb(141, 103, 39)'>Geohash</a><a href='/tags/Gradle/' style='font-size:16px; color:rgb(159, 164, 177)'>Gradle</a><a href='/tags/HttpServletRequest/' style='font-size:20px; color:rgb(197, 0, 23)'>HttpServletRequest</a><a href='/tags/ICP%E5%A4%87%E6%A1%88/' style='font-size:19px; color:rgb(15, 115, 148)'>ICP备案</a><a href='/tags/IDEA/' style='font-size:16px; color:rgb(135, 46, 100)'>IDEA</a><a href='/tags/IP%E5%B1%9E%E6%80%A7/' style='font-size:16px; color:rgb(160, 35, 183)'>IP属性</a><a href='/tags/Ip2region/' style='font-size:19px; color:rgb(6, 132, 76)'>Ip2region</a><a href='/tags/JDK/' style='font-size:17px; color:rgb(64, 109, 10)'>JDK</a><a href='/tags/JMeter/' style='font-size:20px; color:rgb(117, 190, 178)'>JMeter</a><a href='/tags/JSONP/' style='font-size:18px; color:rgb(50, 178, 93)'>JSONP</a><a href='/tags/Jar/' style='font-size:20px; color:rgb(124, 157, 102)'>Jar</a><a href='/tags/Java/' style='font-size:18px; color:rgb(61, 62, 177)'>Java</a></div></div></div><div class="card-widget card-archives"><div class="card-content"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/05/"><span class="card-archive-list-date">五月 2023</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/03/"><span class="card-archive-list-date">三月 2023</span><span class="card-archive-list-count">3</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/02/"><span class="card-archive-list-date">二月 2023</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/01/"><span class="card-archive-list-date">一月 2023</span><span class="card-archive-list-count">4</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/12/"><span class="card-archive-list-date">十二月 2022</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/09/"><span class="card-archive-list-date">九月 2022</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/08/"><span class="card-archive-list-date">八月 2022</span><span class="card-archive-list-count">3</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/07/"><span class="card-archive-list-date">七月 2022</span><span class="card-archive-list-count">6</span></a></li><li class="card-archive-list-item more is-center"><a class="card-archive-list-link-more" href="/archives">
              <span>查看更多</span><i class="fas fa-angle-right"  ></i></a></li></ul></div></div><div class="card-widget card-webinfo"><div class="card-content"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="webinfo-article-name">文章数目 :</div><div class="webinfo-article-count">64</div></div><div class="webinfo-item"><div class="webinfo-site-wordcount-name">本站总字数 :</div><div class="webinfo-site-wordcount">161.3k</div></div><div class="webinfo-item">      <div class="webinfo-site-uv-name">本站访客数 :</div><div class="webinfo-site-uv-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="webinfo-site-name">本站总访问量 :</div><div class="webinfo-site-pv-count" id="busuanzi_value_site_pv"></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/file/bg1.jpg)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2023 By 灵熙云</div><div class="framework-info"><span>Copyright Ⓒ 灵熙云工作室. All rights reserved.</span></div><div class="footer_custom_text">Hi, welcome to my blog !</div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div class="search-mask"></div><script src="https://fastly.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://fastly.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://fastly.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script defer id="ribbon" src="/js/third-party/canvas-ribbon.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="true"></script><script id="ribbon_piao" mobile="false" src="/js/third-party/piao.js"></script><script src="/js/third-party/activate-power-mode.js"></script><script>POWERMODE.colorful = false;
POWERMODE.shake = false;
document.body.addEventListener('input', POWERMODE);
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://fastly.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://fastly.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js" async></script><script src="https://fastly.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js"></script><script>document.addEventListener('DOMContentLoaded', function() {
  pangu.autoSpacingPage()
})</script><script src="/js/search/local-search.js"></script><script>if (document.getElementsByClassName('mermaid').length) {
  loadScript('https://fastly.jsdelivr.net/npm/mermaid/dist/mermaid.min.js',function () {
    mermaid.initialize({
      theme: 'default',
  })
})
}</script><script src="https://fastly.jsdelivr.net/npm/typed.js"></script><script>var subtitleType = function () {
  var subtitleEffect = true
  fetch('https://v1.hitokoto.cn')
    .then(function (res) {
      return res.json()
    })
    .then(function (data) {
      if (subtitleEffect) {
        var from = '出自 ' + data.from
        var sub = "".length == 0 ? new Array() : "".split(',')
        var both = sub.unshift(data.hitokoto, from)
        var typed = new Typed('#subtitle', {
          strings: sub,
          startDelay: 300,
          typeSpeed: 150,
          loop: true,
          backSpeed: 50,
        })
      } else {
        document.getElementById('subtitle').innerHTML = data.hitokoto
      }
    })
    .catch(function (err) {
      console.error(err)
    })
}
window.addEventListener('load', subtitleType)
</script></body></html>