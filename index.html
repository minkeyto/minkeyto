<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>灵熙云工作室 - 实践出真理！</title><meta name="description" content="空话连篇，不如劳动实践！"><meta name="keywords" content="java,javaweb,mysql,oracle,html,css,javascrip,servlet,spring,Hibernate,Mybatis,Maven,Redis,Linux,Docker"><meta name="author" content="灵熙云,minkeyto@qq.com"><meta name="copyright" content="灵熙云"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/file/favicon.png"><link rel="canonical" href="http://www.goitman.cn/"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="preconnect" href="//zz.bdstatic.com"/><meta name="msvalidate.01" content="8izvf3GqbX"/><meta property="og:type" content="website"><meta property="og:title" content="灵熙云工作室"><meta property="og:url" content="http://www.goitman.cn/"><meta property="og:site_name" content="灵熙云工作室"><meta property="og:description" content="空话连篇，不如劳动实践！"><meta property="og:image" content="http://www.goitman.cn/file/head.jpg"><meta property="article:published_time" content="2022-08-05T08:53:58.587Z"><meta property="article:modified_time" content="2022-08-05T08:53:58.587Z"><meta name="twitter:card" content="summary"><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#000')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fff')
  }
}

var getCookies = function (name) {
  const value = `; ${document.cookie}`
  const parts = value.split(`; ${name}=`)
  if (parts.length === 2) return parts.pop().split(';').shift()
}

var autoChangeMode = 'false'
var t = getCookies('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (Cookies.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?5c009f46ba6df7bc385f101477536214";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: false,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: {"bookmark":{"message_prev":"按","message_next":"键将本页加入书签"},"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  justifiedGallery: {
    js: 'https://fastly.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://fastly.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: true,
  highlightCopy: true,
  highlightLang: true,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false    
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isSidebar: false,
  postUpdate: '2022-08-05 16:53:58'
}</script><noscript><style>
#nav {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><link rel="stylesheet" href="/css/effect.css"><meta name="generator" content="Hexo 6.2.0"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/file/head.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">49</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">192</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">16</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/notes/"><i class="fa-fw fa fa-book"></i><span> 笔记</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-users"></i><span> 友链&amp;留言板</span></a></div></div></div></div><div id="body-wrap"><header class="full_page" id="page-header" style="background-image: url(/file/bg1.jpg)"><nav id="nav"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">灵熙云工作室</a></span><span class="pull-right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/notes/"><i class="fa-fw fa fa-book"></i><span> 笔记</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-users"></i><span> 友链&amp;留言板</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="site-info"><h1 id="site_title">灵熙云工作室</h1><div id="site_subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="https://blog.csdn.net/minkeyto" target="_blank" title="CSDN"><i class="fa fa-rss-square"></i></a><a class="social-icon" href="https://github.com/wangdaicong" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="/file/tb.jpg" target="_blank" title="taobao"><i class="fa fa-shopping-cart"></i></a><a class="social-icon" href="mailto:minkeyto@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="/about/" target="_blank" title="Profile"><i class="fa fa-address-book"></i></a></div></div><div id="scroll_down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout_page" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2022/08/05/%E7%BA%BF%E7%A8%8B%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E3%80%81%E5%B7%A5%E4%BD%9C%E7%AA%83%E5%8F%96%E7%AE%97%E6%B3%95%EF%BC%8C%E4%BD%A0%E6%87%82%E5%90%97/" title="线程数据交换、工作窃取算法，你懂吗？">     <img class="post_bg" data-src="https://s2.loli.net/2022/08/05/F4sO9d3GWjZXMwc.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="线程数据交换、工作窃取算法，你懂吗？"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/08/05/%E7%BA%BF%E7%A8%8B%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E3%80%81%E5%B7%A5%E4%BD%9C%E7%AA%83%E5%8F%96%E7%AE%97%E6%B3%95%EF%BC%8C%E4%BD%A0%E6%87%82%E5%90%97/" title="线程数据交换、工作窃取算法，你懂吗？">线程数据交换、工作窃取算法，你懂吗？</a><div class="article-meta-wrap"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2022-08-05 16:36:56"><i class="far fa-calendar-alt"></i>2022-08-05</span><span class="article-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2022-08-05 16:48:40"><i class="fas fa-history"></i>2022-08-05</span></time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E6%8A%80%E6%9C%AF%E4%B8%93%E9%A2%98/">技术专题</a><i class="fas fa-angle-right"></i><a class="article-meta__categories" href="/categories/%E6%8A%80%E6%9C%AF%E4%B8%93%E9%A2%98/%E5%A4%9A%E7%BA%BF%E7%A8%8B/">多线程</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag article-meta__icon"></i><a class="article-meta__tags" href="/tags/Thread/">Thread</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/Runnable/">Runnable</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/Callable/">Callable</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2/">数据交换</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E5%B7%A5%E4%BD%9C%E7%AA%83%E5%8F%96%E7%AE%97%E6%B3%95/">工作窃取算法</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E9%A1%BA%E5%BA%8F%E8%AE%BF%E9%97%AE/">顺序访问</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E5%B9%B6%E8%A1%8C/">并行</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E4%BB%BB%E5%8A%A1%E6%8B%86%E8%A7%A3/">任务拆解</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/Fork-Join%E6%A1%86%E6%9E%B6/">Fork/Join框架</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/CountDownLatch/">CountDownLatch</a></span></div><div class="content">最近栈长面试了一个 5 年经验的 Java 程序员，简历和个人介绍都提到了精通 Java 多线程，于是我就问了几个多线程方面的问题：


实现多线程有哪几种方式，如何返回结果？
多个线程如何实现顺序访问？
两个线程如何进行数据交换？
如何统计 N 个线程的运行总耗时？
如何将任务拆分成多个子任务执行，最后合并结果？


大概问了他这几个问题，答的并不是太好，3、4、5 题都没有真正答上来，其实这几个问题在 JDK 包中都有答案，但他给的是他个人临时思考的方案，而且我个人觉得可能行不通。
工作 5 年了，这几个题都答不好，有点说不过去，我真是醉了。。
实现多线程有哪几种方式，如何返回结果？

继承Thread类


看jdk源码可以发现，Thread类其实是实现了Runnable接口的一个实例，继承Thread类后需要重写run方法并通过start方法启动线程。
继承Thread类耦合性太强了，因为java只能单继承，所以不利于扩展。


实现Runnable接口


通过实现Runnable接口并重写run方法，并把Runnable实例传给Thread对象&#96;，Thread的st ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2022/08/03/Spring-Retry%20%E5%BE%AA%E7%8E%AF%E9%87%8D%E8%AF%95%E6%A1%86%E6%9E%B6/" title="Spring-Retry 循环重试框架">     <img class="post_bg" data-src="https://s2.loli.net/2022/08/03/aMQLxgHqPXpn7JN.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Spring-Retry 循环重试框架"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/08/03/Spring-Retry%20%E5%BE%AA%E7%8E%AF%E9%87%8D%E8%AF%95%E6%A1%86%E6%9E%B6/" title="Spring-Retry 循环重试框架">Spring-Retry 循环重试框架</a><div class="article-meta-wrap"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2022-08-03 15:38:45"><i class="far fa-calendar-alt"></i>2022-08-03</span><span class="article-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2022-08-03 15:56:51"><i class="fas fa-history"></i>2022-08-03</span></time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E5%BE%AE%E6%9C%8D%E5%8A%A1/">微服务</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag article-meta__icon"></i><a class="article-meta__tags" href="/tags/SpringBoot/">SpringBoot</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E5%BE%AA%E7%8E%AF%E9%87%8D%E8%AF%95/">循环重试</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/Spring-Retry/">Spring-Retry</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/Spring/">Spring</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E5%9B%9E%E8%B0%83/">回调</a></span></div><div class="content">简介在日常的一些场景中，很多需要进行重试的操作。而spring-retry是spring提供的一个基于spring的重试框架，非常简单好用。
Spring应用导入maven坐标&lt;dependency&gt;   &lt;groupId&gt;org.springframework.retry&lt;/groupId&gt;   &lt;artifactId&gt;spring-retry&lt;/artifactId&gt;&lt;/dependency&gt;

调用类@Slf4jpublic class RetryDemo &#123;    public static boolean retryMethod(Integer param) &#123;        int i = new Random().nextInt(param);        log.info(&quot;随机生成的数:&#123;&#125;&quot;, i);        if (1 == i) &#123;            log.info(&quot;为1,返回true.&quot ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2022/07/29/Java%E7%BA%BF%E7%A8%8B%E6%B1%A0ThreadPoolExecutor%E7%B1%BB%E4%BD%BF%E7%94%A8%E8%AF%A6%E8%A7%A3/" title="Java线程池ThreadPoolExecutor类使用详解">     <img class="post_bg" data-src="https://s2.loli.net/2022/07/29/klA3qRFYvzTdMjV.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Java线程池ThreadPoolExecutor类使用详解"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/07/29/Java%E7%BA%BF%E7%A8%8B%E6%B1%A0ThreadPoolExecutor%E7%B1%BB%E4%BD%BF%E7%94%A8%E8%AF%A6%E8%A7%A3/" title="Java线程池ThreadPoolExecutor类使用详解">Java线程池ThreadPoolExecutor类使用详解</a><div class="article-meta-wrap"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2022-07-29 16:17:37"><i class="far fa-calendar-alt"></i>2022-07-29</span><span class="article-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2022-07-29 16:31:58"><i class="fas fa-history"></i>2022-07-29</span></time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E6%8A%80%E6%9C%AF%E4%B8%93%E9%A2%98/">技术专题</a><i class="fas fa-angle-right"></i><a class="article-meta__categories" href="/categories/%E6%8A%80%E6%9C%AF%E4%B8%93%E9%A2%98/%E5%A4%9A%E7%BA%BF%E7%A8%8B/">多线程</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag article-meta__icon"></i><a class="article-meta__tags" href="/tags/ThreadPoolExecutor/">ThreadPoolExecutor</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E4%BB%BB%E5%8A%A1%E9%98%9F%E5%88%97/">任务队列</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/ArrayBlockingQueue/">ArrayBlockingQueue</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/LinkedBlockingQueue/">LinkedBlockingQueue</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E6%8B%92%E7%BB%9D%E7%AD%96%E7%95%A5/">拒绝策略</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/AbortPolicy/">AbortPolicy</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/CallerRunsPolicy/">CallerRunsPolicy</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/ThreadFactory/">ThreadFactory</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E7%BA%BF%E7%A8%8B%E6%B1%A0/">线程池</a></span></div><div class="content">在《阿里巴巴java开发手册》中指出了线程资源必须通过线程池提供，不允许在应用中自行显示的创建线程，这样一方面是线程的创建更加规范，可以合理控制开辟线程的数量；另一方面线程的细节管理交给线程池处理，优化了资源的开销。而线程池不允许使用Executors去创建，而要通过ThreadPoolExecutor方式，这一方面是由于jdk中Executor框架虽然提供了如newFixedThreadPool()、newSingleThreadExecutor()、newCachedThreadPool()等创建线程池的方法，但都有其局限性，不够灵活；另外由于前面几种方法内部也是通过ThreadPoolExecutor方式实现，使用ThreadPoolExecutor有助于大家明确线程池的运行规则，创建符合自己的业务场景需要的线程池，避免资源耗尽的风险。
下面我们就对ThreadPoolExecutor的使用方法进行一个详细的概述。
首先看下ThreadPoolExecutor的构造函数
public ThreadPoolExecutor(int corePoolSize,             ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2022/07/29/%E4%BC%98%E6%83%A0%E5%88%B8%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3/" title="优惠券系统设计思想">     <img class="post_bg" data-src="https://s2.loli.net/2022/07/29/UqNdbrIWx2SzP67.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="优惠券系统设计思想"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/07/29/%E4%BC%98%E6%83%A0%E5%88%B8%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3/" title="优惠券系统设计思想">优惠券系统设计思想</a><div class="article-meta-wrap"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2022-07-29 10:01:17"><i class="far fa-calendar-alt"></i>2022-07-29</span><span class="article-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2022-07-29 10:16:52"><i class="fas fa-history"></i>2022-07-29</span></time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3/">设计思想</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag article-meta__icon"></i><a class="article-meta__tags" href="/tags/%E4%BC%98%E6%83%A0%E5%88%B8/">优惠券</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E5%8F%91%E5%88%B8/">发券</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E9%A2%86%E5%88%B8/">领券</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E7%94%A8%E5%88%B8/">用券</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E5%95%86%E5%AE%B6%E4%BE%A7/">商家侧</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E7%94%A8%E6%88%B7%E4%BE%A7/">用户侧</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1/">系统设计</a></span></div><div class="content">场景电商大厂常见促销手段：


优惠券
拼团
砍价
老带新


优惠券的种类

满减券
直减券
折扣券


优惠券系统的核心流程发券
发券的方式：同步发送 or 异步发送

领券

谁能领？


所有用户 or 指定的用户


领取上限


一个优惠券最多能领取多少张？


领取方式


用户主动领取 or 自动发放被动领取
用券

作用范围


商品、商户、类目


计算方式


是否互斥、是否达到门槛等
需求拆解商家侧

创建优惠券
发送优惠券


用户侧

领取优惠券
下单
使用优惠券
支付


服务服务结构设计
优惠券系统设计技术难点

券的分布式事务，使用券的过程会出现的分布式问题分析?
如何防止超发?
如何大批量给用户发券?
如何限制券的使用条件?
如何防止用户重复领券?


存储表单设计券批次（券模板）指一批优惠券的抽象、模板，包含优惠券的大部分属性。
如商家创建了一批优惠券，共1000张，使用时间为2022-11-11 00:00:00 ~ 2022-11-11 23:59:59，规定只有数码类目商品才能使用，满100减50。

券发放到用户的一个实体，已与用户绑定。
 ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2022/07/26/%E5%A6%82%E4%BD%95%E4%BC%98%E9%9B%85%E7%9A%84%E8%87%AA%E5%AE%9A%E4%B9%89%20ThreadPoolExecutor%20%E7%BA%BF%E7%A8%8B%E6%B1%A0/" title="如何优雅的自定义 ThreadPoolExecutor 线程池">     <img class="post_bg" data-src="https://s2.loli.net/2022/07/26/up4cSifCyrJsY8Z.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="如何优雅的自定义 ThreadPoolExecutor 线程池"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/07/26/%E5%A6%82%E4%BD%95%E4%BC%98%E9%9B%85%E7%9A%84%E8%87%AA%E5%AE%9A%E4%B9%89%20ThreadPoolExecutor%20%E7%BA%BF%E7%A8%8B%E6%B1%A0/" title="如何优雅的自定义 ThreadPoolExecutor 线程池">如何优雅的自定义 ThreadPoolExecutor 线程池</a><div class="article-meta-wrap"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2022-07-26 15:57:58"><i class="far fa-calendar-alt"></i>2022-07-26</span><span class="article-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2022-07-26 16:18:37"><i class="fas fa-history"></i>2022-07-26</span></time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E6%8A%80%E6%9C%AF%E4%B8%93%E9%A2%98/">技术专题</a><i class="fas fa-angle-right"></i><a class="article-meta__categories" href="/categories/%E6%8A%80%E6%9C%AF%E4%B8%93%E9%A2%98/%E5%A4%9A%E7%BA%BF%E7%A8%8B/">多线程</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag article-meta__icon"></i><a class="article-meta__tags" href="/tags/ThreadPoolExecutor/">ThreadPoolExecutor</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E7%BA%BF%E7%A8%8B%E6%B1%A0/">线程池</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/Thread/">Thread</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/Runnable/">Runnable</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/Callable/">Callable</a></span></div><div class="content">概述java 中经常需要用到多线程来处理一些业务，非常不建议单纯使用继承Thread或者实现Runnable接口的方式来创建线程，那样势必有创建及销毁线程耗费资源、线程上下文切换问题。同时创建过多的线程也可能引发资源耗尽的风险，这个时候引入线程池比较合理，方便线程任务的管理。
java中涉及到线程池的相关类均在 jdk 1.5 开始的java.util.concurrent包中，涉及到的几个核心类及接口包括：Executor、Executors、ExecutorService、ThreadPoolExecutor、FutureTask、Callable、Runnable等。
JDK 自动创建线程池的几种方式都封装在Executors工具类中：


newFixedThreadPool


使用的构造方式为
new ThreadPoolExecutor(var0, var0, 0L, TimeUnit.MILLISECONDS, new LinkedBlockingQueue())

设置了corePoolSize=maxPoolSize，keepAliveTime=0(此时该参数没作用 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2022/07/19/%E9%80%9A%E7%94%A8Service%20+%20%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%AE%8C%E7%BE%8E%E8%A7%A3%E5%86%B3%E6%89%B9%E5%A4%84%E7%90%86%E9%97%AE%E9%A2%98/" title="通用Service + 多线程完美解决批处理问题">     <img class="post_bg" data-src="https://s2.loli.net/2022/07/19/kA8NoEuy29wmG5n.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="通用Service + 多线程完美解决批处理问题"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/07/19/%E9%80%9A%E7%94%A8Service%20+%20%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%AE%8C%E7%BE%8E%E8%A7%A3%E5%86%B3%E6%89%B9%E5%A4%84%E7%90%86%E9%97%AE%E9%A2%98/" title="通用Service + 多线程完美解决批处理问题">通用Service + 多线程完美解决批处理问题</a><div class="article-meta-wrap"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2022-07-19 15:05:57"><i class="far fa-calendar-alt"></i>2022-07-19</span><span class="article-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2022-07-29 16:31:25"><i class="fas fa-history"></i>2022-07-29</span></time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E6%8A%80%E6%9C%AF%E4%B8%93%E9%A2%98/">技术专题</a><i class="fas fa-angle-right"></i><a class="article-meta__categories" href="/categories/%E6%8A%80%E6%9C%AF%E4%B8%93%E9%A2%98/%E5%A4%9A%E7%BA%BF%E7%A8%8B/">多线程</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag article-meta__icon"></i><a class="article-meta__tags" href="/tags/Runnable/">Runnable</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/Callable/">Callable</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/">多线程</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E4%BA%8B%E5%8A%A1%E6%8E%A7%E5%88%B6/">事务控制</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/java8/">java8</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E5%8F%8C%E9%87%8D%E5%87%BD%E6%95%B0/">双重函数</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E6%B3%9B%E5%9E%8B/">泛型</a></span></div><div class="content">前言在对数据量大的情况下，进行批量操作的时候，效率直接拉跨，同时还要考虑事务机制问题。那是否有既简单又通用的批处理思路呢？当然，多线程执行批量任务就是一种十分重要的操作思路
步骤
获取数据库连接，控制事务机制
对大集合进行拆分成N个小集合。
开启线程池，对小集合进行批量更新操作，并返回执行结果。
线程批量提交，返回Future对象，进而判断事务是否需要提交或回滚

实战Servicepackage cn.goitman.service;import com.google.common.collect.Lists;import org.apache.ibatis.session.SqlSession;import org.apache.ibatis.session.SqlSessionFactory;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Service;import java.sql.Connection;import java ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2022/07/09/SpringBoot%E5%90%8C%E6%97%B6%E6%94%AF%E6%8C%81%20form%20%E8%A1%A8%E5%8D%95%E3%80%81form-data%E3%80%81json%20%E7%9A%84%E4%BC%98%E9%9B%85%E5%86%99%E6%B3%95/" title="SpringBoot同时支持 form 表单、form-data、json 的优雅写法">     <img class="post_bg" data-src="https://s2.loli.net/2022/07/09/v7AEHYBnRPbskaj.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SpringBoot同时支持 form 表单、form-data、json 的优雅写法"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/07/09/SpringBoot%E5%90%8C%E6%97%B6%E6%94%AF%E6%8C%81%20form%20%E8%A1%A8%E5%8D%95%E3%80%81form-data%E3%80%81json%20%E7%9A%84%E4%BC%98%E9%9B%85%E5%86%99%E6%B3%95/" title="SpringBoot同时支持 form 表单、form-data、json 的优雅写法">SpringBoot同时支持 form 表单、form-data、json 的优雅写法</a><div class="article-meta-wrap"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2022-07-09 02:07:16"><i class="far fa-calendar-alt"></i>2022-07-09</span><span class="article-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2022-07-09 02:18:28"><i class="fas fa-history"></i>2022-07-09</span></time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E5%BE%AE%E6%9C%8D%E5%8A%A1/">微服务</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag article-meta__icon"></i><a class="article-meta__tags" href="/tags/SpringBoot/">SpringBoot</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/form/">form</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/form-data/">form-data</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/json/">json</a></span></div><div class="content">在 Java 中，一个接口只支持一种 content-type，json 就用 @RequestBody，form 表单就用 @RequestParam 或不写，form-data 就用 MultipartFile。
兼容版本如果要把在一个接口中同时兼容三种，比较笨的办法就是获取 HttpServletRequest，然后自己再写方法解析。类似如下：
private Map&lt;String, Object&gt; getParams(HttpServletRequest request) &#123;    String contentType = request.getContentType();    if (contentType.contains(&quot;application/json&quot;)) &#123;        // json 解析...        return null;    &#125; else if (contentType.contains(&quot;application/x-www-form-urlencoded&quot;)) ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2022/07/06/%E4%B8%80%E9%94%AE%E9%83%A8%E7%BD%B2Redis%E4%BB%BB%E6%84%8F%E7%89%88%E6%9C%AC/" title="一键部署Redis任意版本">     <img class="post_bg" data-src="https://s2.loli.net/2022/07/06/VOcJRdtLrA7oP18.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="一键部署Redis任意版本"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/07/06/%E4%B8%80%E9%94%AE%E9%83%A8%E7%BD%B2Redis%E4%BB%BB%E6%84%8F%E7%89%88%E6%9C%AC/" title="一键部署Redis任意版本">一键部署Redis任意版本</a><div class="article-meta-wrap"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2022-07-06 10:36:09"><i class="far fa-calendar-alt"></i>2022-07-06</span><span class="article-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2022-07-06 10:57:42"><i class="fas fa-history"></i>2022-07-06</span></time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/">服务器</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag article-meta__icon"></i><a class="article-meta__tags" href="/tags/Linux/">Linux</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/Redis/">Redis</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E7%BC%93%E5%AD%98/">缓存</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/shell%E8%84%9A%E6%9C%AC/">shell脚本</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E9%83%A8%E7%BD%B2/">部署</a></span></div><div class="content">今天给大家分享一个超级实用的脚本，Linux环境下一键自动安装部署Redis的任意版本，记住是任意版本哦！

脚本用法：chmod 755 redis-install.sh &amp;&amp; sh redis-install.sh 4.0.10 （后面跟的是你需要的版本号，需要什么版本就写什么版本），我这里安装的4.0.10

执行脚本#! /usr/bin/bash##redis任何版本全程自动化源码编译安装##用法： sh redis-install.sh 4.0.10 （后面跟的是你需要的版本号，需要什么版本就写什么版本），我这里安装的4.0.10version=$1usage()&#123;echo &quot;usage: $0 version&quot;&#125;if [ $# -ne 1 ]thenusageexit -1fi#Redis安装包下载cd /usr/local/srcif [ ! -f redis-$&#123;version&#125;.tar.gz ]thencurl -o /usr/local/src/redis-$&#123;version&# ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2022/06/29/Redis%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%E7%9A%848%E5%A4%A7%E5%9D%91/" title="Redis分布式锁的8大坑">     <img class="post_bg" data-src="https://s2.loli.net/2022/06/29/wOHE6nSBAbjF9Dd.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Redis分布式锁的8大坑"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/06/29/Redis%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%E7%9A%848%E5%A4%A7%E5%9D%91/" title="Redis分布式锁的8大坑">Redis分布式锁的8大坑</a><div class="article-meta-wrap"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2022-06-29 16:27:46"><i class="far fa-calendar-alt"></i>2022-06-29</span><span class="article-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2022-06-29 16:37:09"><i class="fas fa-history"></i>2022-06-29</span></time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E6%8A%80%E6%9C%AF%E4%B8%93%E9%A2%98/">技术专题</a><i class="fas fa-angle-right"></i><a class="article-meta__categories" href="/categories/%E6%8A%80%E6%9C%AF%E4%B8%93%E9%A2%98/%E7%BC%93%E5%AD%98/">缓存</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag article-meta__icon"></i><a class="article-meta__tags" href="/tags/%E5%8F%AF%E9%87%8D%E5%85%A5%E9%94%81/">可重入锁</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6/">主从复制</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/Redis%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81/">Redis分布式锁</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E5%8E%9F%E5%AD%90%E6%80%A7/">原子性</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E8%AF%BB%E5%86%99%E9%94%81/">读写锁</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/lua%E8%84%9A%E6%9C%AC/">lua脚本</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/RedissonRedLock/">RedissonRedLock</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/Redisson/">Redisson</a></span></div><div class="content">在分布式系统中，由于Redis分布式锁相对于更简单和高效，成为了分布式锁的首先，被用到了很多实际业务场景当中。
但不是说用了Redis分布式锁，就可以高枕无忧了，如果没有用好或者用对，也会引来一些意想不到的问题。
今天一起聊聊Redis分布式锁的一些坑，给有需要的朋友一个参考。

非原子操作使用Redis的分布式锁，首先想到的可能是setNx命令。
if (jedis.setnx(lockKey, val) == 1) &#123;   jedis.expire(lockKey, timeout);&#125;

容易，三下五除二就可以把代码写好。

这段代码确实可以加锁成功，但有没有发现什么问题？
加锁操作和后面的设置超时时间是分开的，并非原子操作。
假如加锁成功，但是设置超时时间失败了，该lockKey就变成永不失效。假如在高并发场景中，有大量的lockKey加锁成功了，但不会失效，有可能直接导致redis内存空间不足。

那么，有没有保证原子性的加锁命令呢？
答案是：有，请看下面。
忘了释放锁上面说到使用setNx命令加锁操作和设置超时时间是分开的，并非原子操作。
而在Redis ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2022/06/21/SpringBoot%E6%89%93%E5%8C%85%20+%20shell%E8%84%9A%E6%9C%AC%E9%83%A8%E7%BD%B2/" title="SpringBoot打包 + shell脚本部署">     <img class="post_bg" data-src="https://s2.loli.net/2022/06/21/RJUQtBcfWdCZIMF.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SpringBoot打包 + shell脚本部署"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/06/21/SpringBoot%E6%89%93%E5%8C%85%20+%20shell%E8%84%9A%E6%9C%AC%E9%83%A8%E7%BD%B2/" title="SpringBoot打包 + shell脚本部署">SpringBoot打包 + shell脚本部署</a><div class="article-meta-wrap"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2022-06-21 15:54:06"><i class="far fa-calendar-alt"></i>2022-06-21</span><span class="article-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2022-06-21 16:07:57"><i class="fas fa-history"></i>2022-06-21</span></time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/">服务器</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag article-meta__icon"></i><a class="article-meta__tags" href="/tags/SpringBoot/">SpringBoot</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/shell%E8%84%9A%E6%9C%AC/">shell脚本</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E9%83%A8%E7%BD%B2/">部署</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/assembly/">assembly</a></span></div><div class="content">SpringBoot打包并结合shell脚本命令部署，重点在分享一个shell程序启动工具，希望能便利工作：


profiles指定不同环境的配置
maven-assembly-plugin打发布压缩包
shenniu_publish.sh程序启动工具
linux上使用shenniu_publish.sh启动程序


示例项目文件结构：

profiles指定不同环境的配置通常一套程序分为了很多个部署环境：开发，测试，uat，线上 等，要想对这些环境区分配置文件，可以通过两种方式：


通过application.yml中编码指定profile.active=uat方式指定
通过pom.xml中profiles来区分不同环境对应的配置文件夹，人工可以手动在idea勾选生成不同环境的包(推荐)


这里要讲的是第二种，首先在pom.xml中配置如下内容： 
&lt;profiles&gt;    &lt;profile&gt;        &lt;id&gt;node&lt;/id&gt;        &lt;properties&gt;            &lt;!--传递给 ...</div></div></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/2/"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside_content" id="aside_content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><img class="avatar-img" src="/file/head.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">灵熙云</div><div class="author-info__description">空话连篇，不如劳动实践！</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives"><div class="headline">文章</div><div class="length_num">49</div></a></div><div class="card-info-data-item is-center">      <a href="/tags"><div class="headline">标签</div><div class="length_num">192</div></a></div><div class="card-info-data-item is-center">     <a href="/categories"><div class="headline">分类</div><div class="length_num">16</div></a></div></div><div class="card-info-bookmark is-center"><button class="button--animated" id="bookmark-it" type="button" title="加入书签"><i class="fas fa-bookmark"></i><span>加入书签</span></button></div><div class="card-info-social-icons is-center"><a class="social-icon" href="https://blog.csdn.net/minkeyto" target="_blank" title="CSDN"><i class="fa fa-rss-square"></i></a><a class="social-icon" href="https://github.com/wangdaicong" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="/file/tb.jpg" target="_blank" title="taobao"><i class="fa fa-shopping-cart"></i></a><a class="social-icon" href="mailto:minkeyto@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="/about/" target="_blank" title="Profile"><i class="fa fa-address-book"></i></a></div></div></div><div class="card-widget card-announcement"><div class="card-content"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">你好，欢迎来到我的博客！<img src="/file/wx.png"></div></div></div><div class="card-widget card-recent-post"><div class="card-content"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-recent-item"><div class="aside-recent-post"><a href="/2022/08/05/%E7%BA%BF%E7%A8%8B%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E3%80%81%E5%B7%A5%E4%BD%9C%E7%AA%83%E5%8F%96%E7%AE%97%E6%B3%95%EF%BC%8C%E4%BD%A0%E6%87%82%E5%90%97/"><div class="aside-post-cover"><img class="aside-post-bg" data-src="https://s2.loli.net/2022/08/05/F4sO9d3GWjZXMwc.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" title="线程数据交换、工作窃取算法，你懂吗？" alt="线程数据交换、工作窃取算法，你懂吗？"/></div><div class="aside-post-title"><div class="aside-post_title" href="/2022/08/05/%E7%BA%BF%E7%A8%8B%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E3%80%81%E5%B7%A5%E4%BD%9C%E7%AA%83%E5%8F%96%E7%AE%97%E6%B3%95%EF%BC%8C%E4%BD%A0%E6%87%82%E5%90%97/" title="线程数据交换、工作窃取算法，你懂吗？">线程数据交换、工作窃取算法，你懂吗？</div><time class="aside-post_meta post-meta__date" title="发表于 2022-08-05 16:36:56">2022-08-05</time></div></a></div><div class="aside-recent-post"><a href="/2022/08/03/Spring-Retry%20%E5%BE%AA%E7%8E%AF%E9%87%8D%E8%AF%95%E6%A1%86%E6%9E%B6/"><div class="aside-post-cover"><img class="aside-post-bg" data-src="https://s2.loli.net/2022/08/03/aMQLxgHqPXpn7JN.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" title="Spring-Retry 循环重试框架" alt="Spring-Retry 循环重试框架"/></div><div class="aside-post-title"><div class="aside-post_title" href="/2022/08/03/Spring-Retry%20%E5%BE%AA%E7%8E%AF%E9%87%8D%E8%AF%95%E6%A1%86%E6%9E%B6/" title="Spring-Retry 循环重试框架">Spring-Retry 循环重试框架</div><time class="aside-post_meta post-meta__date" title="发表于 2022-08-03 15:38:45">2022-08-03</time></div></a></div><div class="aside-recent-post"><a href="/2022/07/29/Java%E7%BA%BF%E7%A8%8B%E6%B1%A0ThreadPoolExecutor%E7%B1%BB%E4%BD%BF%E7%94%A8%E8%AF%A6%E8%A7%A3/"><div class="aside-post-cover"><img class="aside-post-bg" data-src="https://s2.loli.net/2022/07/29/klA3qRFYvzTdMjV.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" title="Java线程池ThreadPoolExecutor类使用详解" alt="Java线程池ThreadPoolExecutor类使用详解"/></div><div class="aside-post-title"><div class="aside-post_title" href="/2022/07/29/Java%E7%BA%BF%E7%A8%8B%E6%B1%A0ThreadPoolExecutor%E7%B1%BB%E4%BD%BF%E7%94%A8%E8%AF%A6%E8%A7%A3/" title="Java线程池ThreadPoolExecutor类使用详解">Java线程池ThreadPoolExecutor类使用详解</div><time class="aside-post_meta post-meta__date" title="发表于 2022-07-29 16:17:37">2022-07-29</time></div></a></div><div class="aside-recent-post"><a href="/2022/07/29/%E4%BC%98%E6%83%A0%E5%88%B8%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3/"><div class="aside-post-cover"><img class="aside-post-bg" data-src="https://s2.loli.net/2022/07/29/UqNdbrIWx2SzP67.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" title="优惠券系统设计思想" alt="优惠券系统设计思想"/></div><div class="aside-post-title"><div class="aside-post_title" href="/2022/07/29/%E4%BC%98%E6%83%A0%E5%88%B8%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3/" title="优惠券系统设计思想">优惠券系统设计思想</div><time class="aside-post_meta post-meta__date" title="发表于 2022-07-29 10:01:17">2022-07-29</time></div></a></div><div class="aside-recent-post"><a href="/2022/07/26/%E5%A6%82%E4%BD%95%E4%BC%98%E9%9B%85%E7%9A%84%E8%87%AA%E5%AE%9A%E4%B9%89%20ThreadPoolExecutor%20%E7%BA%BF%E7%A8%8B%E6%B1%A0/"><div class="aside-post-cover"><img class="aside-post-bg" data-src="https://s2.loli.net/2022/07/26/up4cSifCyrJsY8Z.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" title="如何优雅的自定义 ThreadPoolExecutor 线程池" alt="如何优雅的自定义 ThreadPoolExecutor 线程池"/></div><div class="aside-post-title"><div class="aside-post_title" href="/2022/07/26/%E5%A6%82%E4%BD%95%E4%BC%98%E9%9B%85%E7%9A%84%E8%87%AA%E5%AE%9A%E4%B9%89%20ThreadPoolExecutor%20%E7%BA%BF%E7%A8%8B%E6%B1%A0/" title="如何优雅的自定义 ThreadPoolExecutor 线程池">如何优雅的自定义 ThreadPoolExecutor 线程池</div><time class="aside-post_meta post-meta__date" title="发表于 2022-07-26 15:57:58">2022-07-26</time></div></a></div></div></div></div><div class="card-widget card-categories"><div class="card-content"><div class="item-headline"><i class="fas fa-folder-open"></i><span>分类</span></div><ul class="card-category-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Java%E5%9F%BA%E7%A1%80/"><span class="card-category-list-name">Java基础</span><span class="card-category-list-count">6</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E5%BE%AE%E6%9C%8D%E5%8A%A1/"><span class="card-category-list-name">微服务</span><span class="card-category-list-count">4</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%8A%80%E6%9C%AF%E4%B8%93%E9%A2%98/"><span class="card-category-list-name">技术专题</span><span class="card-category-list-count">17</span></a></li><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%8A%80%E6%9C%AF%E4%B8%93%E9%A2%98/%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6/"><span class="card-category-list-name">任务调度</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%8A%80%E6%9C%AF%E4%B8%93%E9%A2%98/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"><span class="card-category-list-name">多线程</span><span class="card-category-list-count">4</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%8A%80%E6%9C%AF%E4%B8%93%E9%A2%98/%E5%AF%BC%E5%85%A5%E5%AF%BC%E5%87%BA/"><span class="card-category-list-name">导入导出</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%8A%80%E6%9C%AF%E4%B8%93%E9%A2%98/%E5%B7%A5%E4%BD%9C%E6%B5%81/"><span class="card-category-list-name">工作流</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%8A%80%E6%9C%AF%E4%B8%93%E9%A2%98/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/"><span class="card-category-list-name">消息队列</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%8A%80%E6%9C%AF%E4%B8%93%E9%A2%98/%E7%AE%97%E6%B3%95/"><span class="card-category-list-name">算法</span><span class="card-category-list-count">4</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%8A%80%E6%9C%AF%E4%B8%93%E9%A2%98/%E7%BC%93%E5%AD%98/"><span class="card-category-list-name">缓存</span><span class="card-category-list-count">4</span></a></li></ul><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%95%8F%E6%8D%B7%E5%BC%80%E5%8F%91/"><span class="card-category-list-name">敏捷开发</span><span class="card-category-list-count">4</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"><span class="card-category-list-name">数据库</span><span class="card-category-list-count">6</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/"><span class="card-category-list-name">服务器</span><span class="card-category-list-count">6</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E7%A8%8B%E5%BA%8F%E4%BA%BA%E7%94%9F/"><span class="card-category-list-name">程序人生</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3/"><span class="card-category-list-name">设计思想</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E8%BE%85%E5%8A%A9%E5%B7%A5%E5%85%B7/"><span class="card-category-list-name">辅助工具</span><span class="card-category-list-count">3</span></a></li>
                       
            </ul></div></div><div class="card-widget card-tags"><div class="card-content"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href='/tags/AbortPolicy/' style='font-size:21px; color:rgb(32, 57, 189)'>AbortPolicy</a><a href='/tags/Activiti/' style='font-size:18px; color:rgb(50, 9, 190)'>Activiti</a><a href='/tags/Apifox/' style='font-size:20px; color:rgb(122, 34, 175)'>Apifox</a><a href='/tags/ArrayBlockingQueue/' style='font-size:19px; color:rgb(40, 52, 170)'>ArrayBlockingQueue</a><a href='/tags/CORS/' style='font-size:20px; color:rgb(99, 115, 54)'>CORS</a><a href='/tags/Caddy/' style='font-size:21px; color:rgb(66, 87, 180)'>Caddy</a><a href='/tags/Callable/' style='font-size:19px; color:rgb(135, 11, 44)'>Callable</a><a href='/tags/CallerRunsPolicy/' style='font-size:17px; color:rgb(17, 143, 86)'>CallerRunsPolicy</a><a href='/tags/CollectionUtils/' style='font-size:16px; color:rgb(147, 79, 123)'>CollectionUtils</a><a href='/tags/CountDownLatch/' style='font-size:17px; color:rgb(3, 166, 54)'>CountDownLatch</a><a href='/tags/DO/' style='font-size:19px; color:rgb(14, 190, 131)'>DO</a><a href='/tags/DTO/' style='font-size:21px; color:rgb(195, 160, 22)'>DTO</a><a href='/tags/DelayQueue/' style='font-size:18px; color:rgb(45, 139, 71)'>DelayQueue</a><a href='/tags/Druid/' style='font-size:20px; color:rgb(96, 140, 195)'>Druid</a><a href='/tags/ELK/' style='font-size:21px; color:rgb(122, 15, 196)'>ELK</a><a href='/tags/Elasticsearch/' style='font-size:16px; color:rgb(111, 87, 31)'>Elasticsearch</a><a href='/tags/Erupt/' style='font-size:20px; color:rgb(177, 68, 101)'>Erupt</a><a href='/tags/FileCopyUtils/' style='font-size:19px; color:rgb(25, 170, 43)'>FileCopyUtils</a><a href='/tags/Filebeat/' style='font-size:18px; color:rgb(49, 77, 97)'>Filebeat</a><a href='/tags/Fork-Join%E6%A1%86%E6%9E%B6/' style='font-size:20px; color:rgb(82, 64, 89)'>Fork/Join框架</a><a href='/tags/Geohash/' style='font-size:16px; color:rgb(123, 67, 2)'>Geohash</a><a href='/tags/JDK/' style='font-size:17px; color:rgb(1, 170, 57)'>JDK</a><a href='/tags/JMeter/' style='font-size:20px; color:rgb(140, 48, 83)'>JMeter</a><a href='/tags/JSONP/' style='font-size:17px; color:rgb(62, 133, 59)'>JSONP</a><a href='/tags/Jar/' style='font-size:21px; color:rgb(110, 122, 84)'>Jar</a><a href='/tags/Java/' style='font-size:18px; color:rgb(58, 14, 190)'>Java</a><a href='/tags/Kibana/' style='font-size:17px; color:rgb(91, 185, 141)'>Kibana</a><a href='/tags/LinkedBlockingQueue/' style='font-size:21px; color:rgb(10, 30, 85)'>LinkedBlockingQueue</a><a href='/tags/Linux/' style='font-size:16px; color:rgb(186, 187, 109)'>Linux</a><a href='/tags/Logstash/' style='font-size:20px; color:rgb(129, 68, 53)'>Logstash</a><a href='/tags/MD5/' style='font-size:21px; color:rgb(117, 54, 200)'>MD5</a><a href='/tags/Mock/' style='font-size:20px; color:rgb(80, 98, 180)'>Mock</a><a href='/tags/MySQL/' style='font-size:20px; color:rgb(190, 34, 66)'>MySQL</a><a href='/tags/Netty/' style='font-size:20px; color:rgb(149, 180, 178)'>Netty</a><a href='/tags/Nginx/' style='font-size:21px; color:rgb(38, 1, 53)'>Nginx</a><a href='/tags/Oauth2/' style='font-size:16px; color:rgb(139, 20, 190)'>Oauth2</a><a href='/tags/ObjectUtils/' style='font-size:18px; color:rgb(90, 145, 194)'>ObjectUtils</a><a href='/tags/PO/' style='font-size:20px; color:rgb(171, 37, 39)'>PO</a><a href='/tags/Postman/' style='font-size:18px; color:rgb(129, 4, 169)'>Postman</a><a href='/tags/Quartz/' style='font-size:16px; color:rgb(152, 29, 98)'>Quartz</a></div></div></div><div class="card-widget card-archives"><div class="card-content"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/08/"><span class="card-archive-list-date">八月 2022</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/07/"><span class="card-archive-list-date">七月 2022</span><span class="card-archive-list-count">6</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/06/"><span class="card-archive-list-date">六月 2022</span><span class="card-archive-list-count">4</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/05/"><span class="card-archive-list-date">五月 2022</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/04/"><span class="card-archive-list-date">四月 2022</span><span class="card-archive-list-count">4</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/03/"><span class="card-archive-list-date">三月 2022</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/02/"><span class="card-archive-list-date">二月 2022</span><span class="card-archive-list-count">4</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/01/"><span class="card-archive-list-date">一月 2022</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item more is-center"><a class="card-archive-list-link-more" href="/archives">
              <span>查看更多</span><i class="fas fa-angle-right"  ></i></a></li></ul></div></div><div class="card-widget card-webinfo"><div class="card-content"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="webinfo-article-name">文章数目 :</div><div class="webinfo-article-count">49</div></div><div class="webinfo-item"><div class="webinfo-site-wordcount-name">本站总字数 :</div><div class="webinfo-site-wordcount">137.7k</div></div><div class="webinfo-item">      <div class="webinfo-site-uv-name">本站访客数 :</div><div class="webinfo-site-uv-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="webinfo-site-name">本站总访问量 :</div><div class="webinfo-site-pv-count" id="busuanzi_value_site_pv"></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/file/bg1.jpg)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2022 By 灵熙云</div><div class="framework-info"><span>Copyright Ⓒ 灵熙云工作室. All rights reserved.</span></div><div class="footer_custom_text">Hi, welcome to my blog !</div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div class="search-mask"></div><script src="https://fastly.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://fastly.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://fastly.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script defer id="ribbon" src="/js/third-party/canvas-ribbon.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="true"></script><script id="ribbon_piao" mobile="false" src="/js/third-party/piao.js"></script><script src="/js/third-party/activate-power-mode.js"></script><script>POWERMODE.colorful = false;
POWERMODE.shake = false;
document.body.addEventListener('input', POWERMODE);
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://fastly.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://fastly.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js" async></script><script src="https://fastly.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js"></script><script>document.addEventListener('DOMContentLoaded', function() {
  pangu.autoSpacingPage()
})</script><script src="/js/search/local-search.js"></script><script>if (document.getElementsByClassName('mermaid').length) {
  loadScript('https://fastly.jsdelivr.net/npm/mermaid/dist/mermaid.min.js',function () {
    mermaid.initialize({
      theme: 'default',
  })
})
}</script><script src="https://fastly.jsdelivr.net/npm/typed.js"></script><script>var subtitleType = function () {
  var subtitleEffect = true
  fetch('https://v1.hitokoto.cn')
    .then(function (res) {
      return res.json()
    })
    .then(function (data) {
      if (subtitleEffect) {
        var from = '出自 ' + data.from
        var sub = "".length == 0 ? new Array() : "".split(',')
        var both = sub.unshift(data.hitokoto, from)
        var typed = new Typed('#subtitle', {
          strings: sub,
          startDelay: 300,
          typeSpeed: 150,
          loop: true,
          backSpeed: 50,
        })
      } else {
        document.getElementById('subtitle').innerHTML = data.hitokoto
      }
    })
    .catch(function (err) {
      console.error(err)
    })
}
window.addEventListener('load', subtitleType)
</script></body></html>